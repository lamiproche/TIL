[09:30~10:30]
오늘은 로그인 기능 구현
회원 테이블 생성해서 조인 기능도 같이 구현할 예정
로그인에 대한 개념이 필요함
우리나라 책을은 세션 나누고 쿠기 나누어서 분리해서 설명
사실은 세션과 쿠키는 같은 개념

오프라인 기준으로 설명을 하자면
멤버쉽카드와 스탬프카드가 있음
여기서의 공통점은 지난번에 온 사람인지 확인하는 것
둘의 차이점은 서로의 내용이 다름
멤버쉽은 번호(식별번호)가 쓰여있고, 스탬프는 번호가 없음
멤버쉽은 나에게 정보가 없고 가게가 정보를 보관함
스탬프카드는 모든 정보는 내가 가지고 있음
멤버쉽은 정보가 가게에 있으므로 안전함, 대신 카드를 잃어버리면 끝
스탬프는 분실과 변조의 위험이 있음

브라우저는 기본적으로 멤버쉽 개념이라 카드를 자주 분실함, 창을 닫아버리면 카드를 분실, 즉 창을 닫아버리면 끝
그래서 다시 로그인을 해야함, 이것이 바로 브라우저에선 세션
그래서 크롬같은 브라우저가 백그라운드에 동작하는 이유임

반면 스탬프 카드는 내가 보관이 가능함
이게 브라우저로 치면 바로 자동로그인 기능, 쿠키 기능임

서드파티 쿠키
개발자도구에서 쿠키탭을 들어가면 각 사이트의 쿠키들을 볼 수 있음
쿠키를 누르면 사이트에서 발행한 내용들을 조회 가능
지금 이건 지갑이라는 개념으로 보면 되고 그 지갑 안에 여러개의 쿠키를 조회 가능

요즘은 세션과 쿠키르 섞어서 쓰는 형태로 바뀜

[10:30~11:30]
결국 세션/쿠키는  지난번에 온 사람인지 체크 하는 것 - session tracking
이 말은 db에서도 쓰임 - connection

우리는 db를 두가지 방법으로 쓰고 있음
jdbc 연결을 지속하지 않는 방식 stateless
워크벤치를 통하여 지속적으로 연결 stateful

http 자체가 stateless임

세션은 httpsession임
쿠키는 말그대로 cookie임

브라우저에서 맨 처음 접속하면 서버에선 아까 말한 멤버쉽카드 같은걸 발급해줌
이 모든 것들이 쿠키
이걸 구분하기 위해 사람들이 만든 용어가 세션쿠키
모든 쿠키는 이름이 있고 값이 있음

그래서 서버에서 발급한 세션쿠키를 브라우저로 보내줌 (리퀘스트 리스폰스 한사이클이라서)
http헤더에 셋 쿠키라는 메세지를 포함하여 전달하는 것임
그다음 브라우저 내부에 보관함

그다음 새로운 페이지 호출 - 아까 받은 세션쿠키값을 무조건 같이 보냄 - 약속임(동일한 도메인에서)
서버에선 세션쿠키값을 읽음
세션은 우리가 제어하는 것이 아닌 was나 webserver에서 관리함

서버는 세션쿠키를 브라우저에 발행할 때 서버에도 세션값을 저장해놓음
그리고 동시에 모든 데이터는 시간을 가지고 있기 때문에 발행시간과 마지막접속시간도 저장
이 공간을 세션저장소라고 함, 메모리공간에 저장
세션은 안쓰는 값을 지워서 메모리 공간을 확보하기 위해 timeout이라는 기능이 있음
마지막접속시간을 기준으로 함, timeout은 기본 30분

[11:30~13:00]
프로그램에선 세션저장소에 어떻게 접속할 것이냐?
답 : 자동으로 찾아준다
httpServletRequest : 브라우저가 보내는 모든 정보를 가공하고 처리해주는 기능
바로 이것을 이용함
여기에 어떤것이 있냐면, request.getSession{}이 있는데 이것을 활용함

가정을 해보자, 두가지의 케이스가 있음
1. 최초(세션쿠기가 없을 때)
2. 재접속 (세션쿠키가 있는 상황)

세션을 할때는 리턴타입이 Httpsession임
세션저장소를 개인락커룸이라고 생각해보자
Httpsession이 바로 개인락커룸
Httpsession session = request.getSession();

최초로 접속할 경우, 공간을 만들고 리모컨을 참조함
재접속시 jsessionid를 가지고 리모컨을 참조

공간에 보관과 삭제를 하는 메소드가 바로 setAttribute(키, 값) 여기서 키는 문자열, 값은 오브젝트
session.setAttribufe("내이름", 내정보(보통dto형식)) 형식으로 보관함
그러면 세션저장소에 내 정보가 저장됌

로그아웃은 반대로 object xxx = session.getAttribute("내이름") 형식으로 체크해서 로그아웃을 시킬지, 튕겨낼지 결정

이 로그인들의 기능들은 모델2로 다시 설계해야함
지금 했던건 개념 설명을 위한 것

[14:00~]
모델2의 제일 중요한 규칙은 모든 겟
보통은 코딩할 떄 로그인 기능을 제일 나중에 붙임, 왜? 기능이 복잡해이니까
